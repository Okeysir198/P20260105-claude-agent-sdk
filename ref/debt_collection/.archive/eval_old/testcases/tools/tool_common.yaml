agent_id: debt_collection
sub_agent_id: tools
description: "Critical happy-path tests for common tools used across all agents"

# Test Data Configuration
default_test_data:
  full_name: "John Smith"
  user_id: "U12345"
  username: "jsmith001"
  outstanding_amount: 2500.00
  overdue_days: 45
  script_type: "ratio1_inflow"
  account_status: "active"
  contract_id: "CT98765"

test_cases:
  # ========================================================================
  # schedule_callback Tests (1 happy-path test)
  # ========================================================================

  - name: "TOL-COM-001: Customer requests callback today"
    test_type: single_turn
    tags: [unit, tools, callback, same_day]
    turns:
      - user_input: "I'm busy right now, can you call me back in about 3 hours?"
        assertions:
          - type: contains_function_call
            value: "schedule_callback"
          - type: llm-rubric
            value: "Agent should calculate appropriate time within business hours (Mon-Sat, 08:00-17:00) and confirm callback time with customer"

  # ========================================================================
  # escalate Tests (1 happy-path test)
  # ========================================================================

  - name: "TOL-COM-004: Customer requests supervisor"
    test_type: single_turn
    tags: [unit, tools, escalation, supervisor_request]
    turns:
      - user_input: "I want to speak to your manager right now!"
        assertions:
          - type: contains_function_call
            value: "escalate"
          - type: function_call_args
            function: "escalate"
            args:
              reason: "customer_request"
          - type: llm-rubric
            value: "Agent should acknowledge request professionally and escalate to supervisor"

  # ========================================================================
  # handle_cancellation_request Tests (1 happy-path test)
  # ========================================================================

  - name: "TOL-COM-007: Customer requests account cancellation"
    test_type: single_turn
    tags: [unit, tools, cancellation, direct_request]
    turns:
      - user_input: "I want to cancel my Cartrack subscription immediately. I'm tired of these calls"
        assertions:
          - type: contains_function_call
            value: "handle_cancellation_request"
          - type: function_call_args
            function: "handle_cancellation_request"
            args:
              contract_id: "CT98765"
          - type: llm-rubric
            value: "Agent should log cancellation request, create support ticket, inform customer that cancellations team will contact them, and NOT cancel immediately"

  # ========================================================================
  # end_call Tests (1 happy-path test)
  # ========================================================================

  - name: "TOL-COM-010: Successful call closure after payment"
    test_type: single_turn
    tags: [unit, tools, end_call, payment_success]
    test_data:
      payment_committed: true
      payment_type: "ptp"
    turns:
      - user_input: "Thank you, that's all sorted now. Goodbye"
        assertions:
          - type: contains_function_call
            value: "end_call"
          - type: function_call_args
            function: "end_call"
            args:
              outcome: "ptp_committed"
          - type: llm-rubric
            value: "Agent should thank customer, confirm payment arrangement, and end call professionally"
